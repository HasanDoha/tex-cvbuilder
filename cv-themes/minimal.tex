% Colors
\definecolor{pagebackground}{HTML}{FFFFFF}
\definecolor{sidebartitle}{HTML}{484849}
\definecolor{sidebartext}{HTML}{6c6c6d}
\definecolor{bodytitle}{HTML}{484849}
\definecolor{bodytext}{HTML}{6c6c6d}
\definecolor{bulletcolor}{HTML}{484849}
\definecolor{linkcolor}{HTML}{3E78B2}
\definecolor{linecolor}{HTML}{484849}
\definecolor{name}{HTML}{484849}
\definecolor{jobtitle}{HTML}{484849}
\RequirePackage[pagecolor=pagebackground, nopagecolor=pagebackground]{pagecolor}

% Heading styles
\titleformat{\section}
{\color{bodytitle}\fontsize{16pt}{16pt}\sffamily\addfontfeature{LetterSpace=2}}
{}{0pt}{}[{\color{linecolor}\titlerule[1pt]}]

\titleformat{\subsection}
{\color{sidebartitle}\fontsize{16pt}{16pt}\sffamily\addfontfeature{LetterSpace=2}}
{}{0pt}{}[{\color{linecolor}\titlerule[1pt]}]

\titleformat{\subsubsection}
{\color{bodytitle}\fontsize{12pt}{12pt}\sffamily\addfontfeature{LetterSpace=2}}
{}{0em}{}

\titlespacing*{\section}{0pt}{0.5cm}{0.4cm}
\titlespacing*{\subsection}{0pt}{0.5cm}{0.4cm}
\titlespacing*{\subsubsection}{0pt}{0.5cm}{0.1cm}

% Defining font styles
\newcommand{\sname}{\color{name}\fontsize{46pt}{46pt}\sffamily\addfontfeature{LetterSpace=3}\MakeUppercase}
\newcommand{\sjobtitle}{\color{jobtitle}\fontsize{22}{22}\sffamily\addfontfeature{LetterSpace=10}\MakeUppercase}

% Defining page styles
\pagestyle{fancy}
\fancypagestyle{firstpagestyle}{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
    \fancyhead[C]{%
        \begin{tikzpicture}[remember picture,overlay]
            \draw [line width=3pt, color=linecolor] ($(current page.north west)-(0,5cm)$) -- ($(current page.north east)-(0,5cm)$);
            \draw [line width=1pt, color=linecolor] ($(current page.north west)+(7cm,-6.25cm)$) -- ($(current page.south west)+(7cm,1cm)$);
        \end{tikzpicture}
    }
}

\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\fancyhead[C]{%
    \begin{tikzpicture}[remember picture,overlay]
        \draw [line width=1pt, color=linecolor] ($(current page.north west)+(7cm,-1cm)$) -- ($(current page.south west)+(7cm,1cm)$);
    \end{tikzpicture}
}

% Layout for name, job title and sidebar
\setcolumnwidth{5cm,12cm}
\setlength{\columnsep}{1.5cm}
\columncolor{sidebartext}[0]
\columncolor{bodytext}[1]

\newcommand{\makeprofile}{
    \thispagestyle{firstpagestyle}
    \begin{center}
        \begin{spacing}{2}
            {\sname\name}
    
            \medskip
            {\sjobtitle\jobtitle}
        \end{spacing}
    \end{center}
    \vspace*{1cm}
}

% Margins
\RequirePackage[left=1cm, right=1cm, top=1.5cm, bottom=1.5cm, footskip=0.5cm, headheight=0.5cm]{geometry}